#! /bin/bash

apt update
apt upgrade -y
apt install default-jre  git -y
git clone https://github.com/dr-mato/minecraft_server.git
apt-get -q=2 install -y cloud-init

FILE_USERDATA=/etc/cloud/cloud.cfg.d/minecraft.cfg
echo "set cloud-init/datasources NoCloud" | debconf-communicate
mkdir -p /etc/cloud/cloud.cfg.d /var/lib/cloud/seed/nocloud-net
cat > /etc/cloud/cloud.cfg.d/99-warnings.cfg <<'EOS'
#cloud-config
warnings:
  dsid_missing_source: off
EOS
echo "Creating $FILE_USERDATA..."
cloud-init init
cloud-init modules --mode=config
cloud-init modules --mode=final